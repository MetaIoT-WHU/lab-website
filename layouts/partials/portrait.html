{{/* Recive Param: Page Object (from content/members) */}}

{{/* 1. Smart variable mapping: adapt to your data structure */}}
{{ $name := .Params.name | default .Title }}
{{ $desc := .Params.description | default .Params.job_title | default .Params.role }}
{{ $image := .Params.image }}

{{/* 2. Link lookup logic: prioritize home-url > link > url > Permalink */}}
{{ $url := .Params.home_url | default (index .Params "home-url") | default .Params.link | default .Permalink }}

<div class="portrait-wrapper">
    <a href="{{ $url | default " #" }}" class="portrait" aria-label="{{ $name }}">

        {{/* 3. Image processing */}}
        {{ if $image }}
        {{ $cleanImage := $image | replaceRE "^\\.\\./" "/" }}

        <img src="/images/loading.gif" data-src="{{ $cleanImage | relURL }}" class="portrait-image lazyload"
            alt="{{ $name }}" loading="lazy" onerror="this.src = '{{ " images/fallback.svg" | relURL }}';
            this.onerror=null;">
        {{ else }}
        <img src="{{ " images/fallback.svg" | relURL }}" class="portrait-image" alt="fallback">
        {{ end }}

        {{/* 4. Information display */}}
        <div class="portrait-info">
            <span class="portrait-name">
                {{ $name }}
            </span>

            {{ if $desc }}
            <span class="portrait-description">
                {{ $desc | markdownify }}
            </span>
            {{ end }}
        </div>

    </a>
</div>